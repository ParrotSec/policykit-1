Description: local privilege escalation using polkit_system_bus_name_get_creds_sync()
Origin: upstream
Bug: https://gitlab.freedesktop.org/polkit/polkit/-/issues/140
Bug-Debian: https://bugs.debian.org/989429
Bug-Debian-Security: https://security-tracker.debian.org/tracker/CVE-2021-3560
Forwarded: not-needed
Author: Salvatore Bonaccorso <carnil@debian.org>
Last-Update: 2021-06-03

--- a/src/polkit/polkitsystembusname.c
+++ b/src/polkit/polkitsystembusname.c
@@ -435,6 +435,9 @@ polkit_system_bus_name_get_creds_sync (PolkitSystemBusName           *system_bus
   while (!((data.retrieved_uid && data.retrieved_pid) || data.caught_error))
     g_main_context_iteration (tmp_context, TRUE);
 
+  if (data.caught_error)
+    goto out;
+
   if (out_uid)
     *out_uid = data.uid;
   if (out_pid)

